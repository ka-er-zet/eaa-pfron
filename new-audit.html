<!DOCTYPE html>
<html lang="pl" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="setup.pageTitle">Raport zgodności z EAA - Konfiguracja audytu</title>

    <!-- Pico CSS (Semantic Framework) -->
    <link rel="stylesheet" href="css/pico.min.css">
    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/style.css?v=14">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.webmanifest">
    <!-- Favicon and app icons (explicit links to avoid 404 on root /favicon.ico) -->
    <link rel="icon" href="favicon.ico">
    <link rel="icon" type="image/svg+xml" href="favicon-eaa.svg">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icon-180.png">

    <!-- Lucide Icons -->
    <script src="js/lucide.min.js"></script>
</head>

<body class="setup-page">

    <a href="#main-content" class="skip-link" data-i18n="home.skipLink">Pomiń nawigację</a>

    <!-- Header -->
    <header class="app-header" role="banner">
        <div class="header-content">
            <a href="index.html" id="app-logo" class="header-icon-container" aria-label="Strona główna - Audyt EN 301 549" data-i18n-aria="navigation.homeHelp">
                <img src="img/eaa.svg" class="app-logo-svg" alt="" aria-hidden="true" />
            </a>
            <div>
                <strong id="header-title" class="header-title" data-i18n="home.headerTitle">EAA-CR</strong>
                <small id="header-subtitle" class="text-muted" data-i18n="setup.headerSubtitle">Konfiguracja audytu</small>
            </div>
        </div>
        <nav class="header-actions" role="navigation" aria-label="Nagłówkowa nawigacja">
            <button class="outline secondary theme-toggle" id="btn-save-audit" data-i18n-aria="navigation.saveAudit">
                <i data-lucide="save" aria-hidden="true"></i>
            </button>
            <button class="outline secondary theme-toggle" onclick="window.utils.toggleTheme()"
                data-i18n-aria="navigation.toggleTheme">
                <i id="theme-icon" data-lucide="moon" aria-hidden="true"></i>
            </button>
        </nav>
    </header>

    <!-- Layout Container -->
    <div id="app-layout" class="app-layout">

        <!-- Main Content -->
        <main id="main-content" role="main">

            <!-- VIEW 1: SETUP (Centered, Full Width) -->
            <div id="view-setup" class="setup-container">
                <div class="setup-header">
                    <h1 class="mb-05" data-i18n="setup.h1">Konfiguracja Audytu</h1>
                </div>

                <form id="audit-setup-form" onsubmit="return false;" novalidate>
                    <!-- Step 1: Product Info -->
                    <article class="mb-2">
                        <header class="section-header">
                            <h2 data-i18n="setup.section1Title">1. Przedmiot audytu</h2>
                        </header>
                        <div class="section-content">
                            <div class="mb-2">
                                <label for="product-name">
                                    <span data-i18n="setup.productNameLabel">Nazwa produktu / Systemu</span>
                                    <span class="text-fail" aria-hidden="true">*</span>
                                    <span class="sr-only">(wymagane)</span>
                                </label>
                                <small id="product-name-helper" class="text-muted"
                                    style="display: block; margin-bottom: 0.5rem;" data-i18n="setup.productNameHelper">
                                    np. Portal Usług Publicznych 2.0
                                </small>
                                <input type="text" id="product-name" name="product-name"
                                    aria-describedby="product-name-helper" required aria-required="true">
                                <small id="product-name-error" class="text-fail hidden" aria-live="assertive" role="alert"
                                    style="display: flex; align-items: center; margin-top: 0;" data-i18n="setup.productNameRequiredError">
                                    <i data-lucide="alert-circle" style="width: 16px; height: 16px; margin-right: 6px;" aria-hidden="true"></i>
                                    Proszę podać nazwę produktu.
                                </small>
                            </div>
                            <div class="mb-2">
                                <label for="product-desc" data-i18n="setup.productDescLabel">Opis / Wersja / URL</label>
                                <small id="product-desc-helper" class="text-muted"
                                    style="display: block; margin-bottom: 0.5rem;" data-i18n="setup.productDescHelper">
                                    np. v1.2.4, https://example.com
                                </small>
                                <input type="text" id="product-desc" name="product-desc"
                                    aria-describedby="product-desc-helper">
                            </div>
                            <div>
                                <label for="auditor-name" data-i18n="setup.auditorNameLabel">Audytor / Organizacja</label>
                                <small id="auditor-name-helper" class="text-muted"
                                    style="display: block; margin-bottom: 0.5rem;" data-i18n="setup.auditorNameHelper">
                                    Imię i&nbsp;nazwisko lub nazwa firmy przeprowadzającej audyt
                                </small>
                                <input type="text" id="auditor-name" name="auditor-name"
                                    aria-describedby="auditor-name-helper">
                            </div>
                        </div>
                    </article>

                    <!-- Profile selection (button only) -->
                    <article class="mb-2" id="profile-selection-article">
                        <header class="section-header">
                            <h2 data-i18n="setup.profileTitle">Profil produktu / usługi</h2>
                        </header>
                        <div class="section-content">
                            <p data-i18n="setup.profileIntro">Wybierz profil, by automatycznie zaznaczyć klauzule, lub wybierz je ręcznie.</p>
                            <details role="region" aria-labelledby="profile-summary">
                                <summary id="profile-summary">
                                    <h3 class="help-title" data-i18n="profile.title">Dostępne profile</h3>
                                </summary>
                                <div style="margin-top: 1rem; padding-left: 1rem; border-left: 2px solid var(--muted-color); text-align: left;">
                                    <fieldset id="profile-fieldset">
                                        <legend class="sr-only">Wybierz profil</legend>
                                        <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                            <!-- Profiles will be loaded here -->
                                        </div>
                                    </fieldset>
                                    <div id="profile-status" aria-live="polite" aria-atomic="true" class="sr-only"></div>
                                </div>
                            </details>
                        </div>
                    </article>

                    <!-- Step 2: Scope -->
                    <article class="mb-2">
                        <header class="section-header">
                            <h2 data-i18n="setup.sectionScopeTitle">3. Zakres audytu (klauzule)</h2>
                            <p id="clauses-helper" class="text-muted text-small mb-0" data-i18n="setup.clausesHelper">Zaznacz obszary, które podlegają
                                ocenie.</p>
                            <small id="clauses-error" class="text-fail hidden mb-0" aria-live="assertive" role="alert"
                                style="display: flex; align-items: center;" data-i18n="setup.clausesRequiredError">
                                <i data-lucide="alert-circle" style="width: 16px; height: 16px; margin-right: 6px;" aria-hidden="true"></i>
                                Proszę wybrać przynajmniej jeden zakres audytu.
                            </small>
                        </header>
                        <div class="section-content">
                            <fieldset class="scope-fieldset" id="clauses-fieldset"
                                aria-describedby="clauses-helper clauses-error">
                                <legend class="sr-only">Wybierz klauzule</legend>
                                <div class="scope-grid" id="scope-grid">
                                    <!-- Clauses will be loaded dynamically from clauses_config.json -->
                                </div>
                            </fieldset>
                            <div id="clauses-status" aria-live="polite" aria-atomic="true" class="sr-only"></div>
                        </div>
                    </article>

                    <!-- Actions -->
                    <div class="form-actions" style="text-align: right;">
                        <button type="submit" id="start-audit-btn" class="btn-auto">
                            Rozpocznij Audyt <i data-lucide="arrow-right" style="margin-left: 8px;"
                                aria-hidden="true"></i>
                        </button>
                    </div>
                </form>
            </div>

        </main>
    </div>

    <footer role="contentinfo" class="app-footer">
        <!-- Inline SVG to allow CSS coloring -->
        <svg class="acr" aria-hidden="true" focusable="false" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path class="fill-color-icon-svg" d="m12.032 3c-3.751 0-6.9913 2.2649-8.4727 5.5212-0.051613-0.0060071-0.10422-0.010045-0.15737-0.010045-0.77358 0-1.4012 0.65435-1.4012 1.4598 0 0.57262 0.31644 1.0681 0.77679 1.3058-0.050761 0.40042-0.077009 0.8095-0.077009 1.2238 0 2.7747 1.1743 5.2742 3.0435 7.0095-0.07315 0.17682-0.11384 0.3729-0.11384 0.57757 0 0.80547 0.62765 1.4581 1.4012 1.4581 0.40083 0 0.7636-0.17511 1.0179-0.45536 1.2087 0.58321 2.5587 0.90904 3.9827 0.90904 1.4407 0 2.8057-0.33309 4.0229-0.9308 0.25243 0.25559 0.59798 0.41183 0.97768 0.41183 0.77358 0 1.4012-0.65267 1.4012-1.4581 0-0.18616-0.034497-0.36512-0.095424-0.52734 1.8581-1.7377 3.0251-4.2293 3.0251-6.9944 0-0.4049-0.024539-0.80502-0.07366-1.1953 0.42451-0.25079 0.70982-0.72473 0.70982-1.269 0-0.80547-0.62764-1.4598-1.4012-1.4598l-0.066964 0.0033482c-1.4688-3.2883-4.726-5.5798-8.4994-5.5798zm0 0.94922c3.3855 0 6.3106 2.0509 7.6373 4.9955-0.28881 0.26731-0.4721 0.65776-0.4721 1.0915 0 0.058316 0.004321 0.11576 0.011718 0.17243-4.7327 2.9164-9.4282 2.9685-14.16 0.15569l-0.26451-0.16071 0.013393-0.11551 0.0050223-0.11719c0-0.40022-0.1556-0.76291-0.40848-1.0262 1.3279-2.9447 4.252-4.9955 7.6373-4.9955zm-0.031808 2.1998a2.5672 2.5672 0 0 0-2.5664 2.5681 2.5672 2.5672 0 0 0 2.5664 2.5664 2.5672 2.5672 0 0 0 2.5664-2.5664 2.5672 2.5672 0 0 0-2.5664-2.5681zm0 0.92578a1.6418 1.6418 0 0 1 1.6406 1.6423 1.6418 1.6418 0 0 1-1.6406 1.6423 1.6418 1.6418 0 0 1-1.6406-1.6423 1.6418 1.6418 0 0 1 1.6406-1.6423zm-8.6283 2.2282c0.362 0 0.65625 0.29889 0.65625 0.66797 0 0.36907-0.29425 0.66797-0.65625 0.66797-0.362 0-0.65625-0.29889-0.65625-0.66797 0-0.36907 0.29425-0.66797 0.65625-0.66797zm17.196 0.063616c0.362 0 0.65625 0.30057 0.65625 0.66964 0 0.36908-0.29425 0.66797-0.65625 0.66797-0.362 0-0.65458-0.29889-0.65458-0.66797 0-0.36907 0.29258-0.66964 0.65458-0.66964zm-16.235 1.6942 0.31975 0.19252c2.0818 1.2233 4.169 1.9265 6.2578 2.1077l-3.8086 5.2701-0.070312-0.003348c-0.24146 0-0.46803 0.064622-0.66629 0.17746-1.6776-1.5643-2.7305-3.8118-2.7305-6.3047 0-0.37511 0.023646-0.74498 0.071987-1.1049 0.23695-0.054756 0.45102-0.17254 0.62612-0.33482zm15.295 0.025111c0.19981 0.2 0.45541 0.33846 0.74163 0.38672 0.039788 0.33681 0.060267 0.68036 0.060267 1.0279 0 2.4724-1.0359 4.7024-2.6886 6.2628-0.20804-0.1274-0.44947-0.20089-0.70815-0.20089-0.10462 0-0.20659 0.012487-0.30469 0.035156l-3.7935-5.2249c2.234-0.1661 4.4672-0.92884 6.6931-2.2868zm-7.7093 2.5195 4.0061 5.5229c-0.18383 0.24685-0.29297 0.55762-0.29297 0.89397 0 0.066057 0.003033 0.13171 0.013393 0.19587-1.095 0.53359-2.32 0.83203-3.6127 0.83203-1.29 0-2.513-0.29762-3.6044-0.83036l0.0050223-0.13225c0-0.41484-0.16643-0.79064-0.43359-1.0564l3.9191-5.4258zm5.0843 5.7472c0.362 0 0.65625 0.30057 0.65625 0.66964 0 0.36908-0.29425 0.66797-0.65625 0.66797-0.362 0-0.65625-0.29889-0.65625-0.66797 0-0.36907 0.29425-0.66964 0.65625-0.66964zm-9.9994 0.06529c0.362 0 0.65458 0.30057 0.65458 0.66964 0 0.36907-0.29257 0.66797-0.65458 0.66797-0.362 0-0.65625-0.2989-0.65625-0.66797 0-0.36908 0.29425-0.66964 0.65625-0.66964z" />
        </svg>
        <span>Aplikacja Dostępna Cyfrowo</span>
    </footer>

    <!-- Application Logic -->
    <script src="js/utils.js?v=14"></script>
    <script type="module" src="js/setup.js?v=14"></script>

    <!-- Global status message for screen readers -->
    <div id="status-message" role="status" aria-live="polite" class="sr-only"></div>
</body>

</html>