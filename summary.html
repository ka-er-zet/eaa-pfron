<!DOCTYPE html>
<html lang="pl" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="summary.pageTitle">Raport zgodności z EAA - Podsumowanie</title>

    <!-- Pico CSS (Semantic Framework) -->
    <link rel="stylesheet" href="css/pico.min.css">
    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/style.css?v=6">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.webmanifest">
    <!-- Favicon and app icons (explicit links to avoid 404 on root /favicon.ico) -->
    <link rel="icon" href="favicon.ico">
    <link rel="icon" type="image/svg+xml" href="favicon-eaa.svg">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icon-180.png">

    <!-- Lucide Icons -->
    <script src="js/lucide.min.js"></script>
    <!-- JSZip for ODT export -->
    <script src="js/jszip.min.js"></script>
</head>

<body class="summary-page">

    <a href="#main-content" class="skip-link" data-i18n="home.skipLink">Pomiń nawigację</a>

    <!-- Header -->
    <header class="app-header" role="banner">
        <div class="header-content">
            <a href="index.html" id="app-logo" class="header-icon-container" aria-label="Strona główna" data-i18n-aria="navigation.homeHelp">
                <img src="/img/eaa.svg" class="app-logo-svg" alt="" aria-hidden="true" />
            </a>
            <div>
                <strong id="header-title" class="header-title" data-i18n="home.headerTitle">EAA-CR</strong>
                <small id="header-subtitle" class="text-muted" data-i18n="summary.headerSubtitle">Wynik audytu</small>
            </div>
        </div>
        <nav class="header-actions" role="navigation" aria-label="Nagłówkowa nawigacja">
            <button class="outline secondary theme-toggle" id="btn-edit-responses" data-i18n-aria="navigation.editResponsesHelp" data-i18n-title="navigation.editResponses" aria-label="Edytuj odpowiedzi" title="Edytuj odpowiedzi">
                <i data-lucide="edit" aria-hidden="true"></i>
            </button>
            <button class="outline secondary theme-toggle" id="btn-edit-config" data-i18n-aria="navigation.editConfigHelp" data-i18n-title="navigation.editConfig" aria-label="Ustawienia audytu" title="Ustawienia audytu">
                <i data-lucide="settings" aria-hidden="true"></i>
            </button>
            <button class="outline secondary theme-toggle" id="btn-save-audit" data-i18n-aria="navigation.saveAuditHelp" data-i18n-title="navigation.saveAudit" aria-label="Zapisz audyt" title="Zapisz audyt">
                <i data-lucide="save" aria-hidden="true"></i>
            </button>
            <button class="outline secondary theme-toggle" onclick="window.utils.toggleTheme()"
                aria-label="Przełącz motyw" title="Przełącz motyw" data-i18n-title="navigation.toggleTheme" data-i18n-aria="navigation.toggleTheme">
                <i id="theme-icon" data-lucide="moon" aria-hidden="true"></i>
            </button>
        </nav>
    </header>

    <!-- Layout Container -->
    <div id="app-layout" class="app-layout">

        <!-- Main Content -->
        <main id="main-content" class="index-main" role="main" tabindex="-1">

            <div class="container">
                <!-- Header Section -->
                <div class="summary-header-section" style="margin-bottom: 1rem;">
                    <div>
                        <h1 data-i18n="summary.reportTitle">Raport Końcowy</h1>
                        <h2 id="summary-product" class="text-muted summary-product-name"
                            style="margin-top: 0.5rem; font-weight: 500;">Ładowanie...</h2>
                    </div>
                </div>

                <!-- Verdict Card -->
                <div id="verdict-card" class="verdict-card">
                    <div class="verdict-icon-wrapper">
                        <i id="verdict-icon" data-lucide="shield-alert" aria-hidden="true"></i>
                    </div>
                    <div class="verdict-content">
                        <small class="verdict-label">WYNIK AUDYTU</small>
                        <h2 id="verdict-title" class="verdict-title">NIEZGODNY (FAILED)</h2>
                        <p id="verdict-desc" class="verdict-desc">Znaleziono błędy krytyczne.</p>
                    </div>
                </div>

                <!-- Edit responses button (same style as New audit) -->
                <div style="margin-top: 1rem; text-align: center;">
                    <button class="secondary outline" id="btn-edit-responses-bottom" style="width: 100%;">
                        <i data-lucide="edit" aria-hidden="true"></i> <span data-i18n="navigation.editResponses">Edytuj odpowiedzi</span>
                    </button>
                </div>

                <!-- Szczegóły -->
                <article class="mb-2">
                    <header class="section-header">
                        <h2>Szczegóły</h2>
                    </header>
                    <div class="section-content">
                        <details>
                            <summary>
                                <span class="summary-closed">Rozwiń szczegóły</span>
                                <span class="summary-open">Zwiń szczegóły</span>
                            </summary>
                            <!-- Issues List (Fail) -->
                            <div class="list-section">
                                <div class="list-header fail-header">
                                    <div class="header-left">
                                        <i data-lucide="x-circle" aria-hidden="true"></i>
                                        <h3 style="margin: 0; font-size: inherit;">NIEZALICZONE (<span
                                                id="count-fail">0</span>)</h3>
                                    </div>
                                    <span class="badge-fail">Wymagana poprawa</span>
                                </div>
                                <div id="list-fail" class="issue-list">
                                    <!-- Items will be injected here -->
                                </div>
                            </div>

                            <!-- To Verify List (Notes/Manual) -->
                            <div class="list-section">
                                <div class="list-header warning-header">
                                    <div class="header-left">
                                        <i data-lucide="alert-circle" aria-hidden="true"></i>
                                        <h3 style="margin: 0; font-size: inherit;">NIETESTOWANE (<span
                                                id="count-verify">0</span>)</h3>
                                    </div>
                                    <span class="badge-warning">Wymagana ocena</span>
                                </div>
                                <div id="list-verify" class="issue-list">
                                    <!-- Items will be injected here -->
                                </div>
                            </div>

                            <!-- NA List -->
                            <div class="list-section">
                                <div class="list-header na-header">
                                    <div class="header-left">
                                        <i data-lucide="minus-circle" aria-hidden="true"></i>
                                        <h3 style="margin: 0; font-size: inherit;">NIE DOTYCZY (<span
                                                id="count-na">0</span>)</h3>
                                    </div>
                                </div>
                                <div id="list-na" class="issue-list">
                                    <!-- Items will be injected here -->
                                </div>
                            </div>

                            <!-- NT List -->
                            <div class="list-section">
                                <div class="list-header nt-header">
                                    <div class="header-left">
                                        <i data-lucide="help-circle" aria-hidden="true"></i>
                                        <h3 style="margin: 0; font-size: inherit;">NIE DO SPRAWDZENIA (<span
                                                id="count-nt">0</span>)</h3>
                                    </div>
                                </div>
                                <div id="list-nt" class="issue-list">
                                    <!-- Items will be injected here -->
                                </div>
                            </div>

                            <!-- Passed List -->
                            <div class="list-section">
                                <div class="list-header success-header">
                                    <div class="header-left">
                                        <i data-lucide="check-circle" aria-hidden="true"></i>
                                        <h3 style="margin: 0; font-size: inherit;">ZALICZONE (<span
                                                id="count-pass">0</span>)</h3>
                                    </div>
                                </div>
                                <div id="list-pass" class="issue-list">
                                    <!-- Items will be injected here -->
                                </div>
                            </div>
                        </details>
                    </div>
                </article>

                <!-- Executive Summary -->
                <article class="mb-2">
                    <header class="section-header">
                        <h2>Komentarz audytorski</h2>
                    </header>
                    <div class="section-content">
                        <label for="executive-summary"
                            style="display:block; margin-bottom: 0.5rem; font-weight: 600;">Treść komentarza</label>
                        <small id="executive-summary-helper" class="text-muted"
                            style="display: block; margin-bottom: 0.5rem;">
                            Wpisz tutaj syntezę audytu dla klienta. Np: 'Mimo dużej liczby zaliczonych testów...'
                        </small>
                        <textarea id="executive-summary" rows="4"
                            aria-describedby="executive-summary-helper"></textarea>
                    </div>
                </article>

                <!-- Export Section -->
                <article class="mb-2">
                    <header class="section-header">
                        <h2 data-i18n="summary.saveAsTitle">Zapisz raport jako:</h2>
                    </header>
                    <div class="section-content grid">
                        <button class="secondary outline" id="export-json-btn" aria-label="Zapisz raport jako JSON" data-i18n-aria="export.exportJson">
                            <i data-lucide="code" aria-hidden="true"></i> <span data-i18n="export.exportJson">JSON</span>
                        </button>
                        <button class="secondary outline" id="export-csv-btn" aria-label="Zapisz raport jako CSV" data-i18n-aria="export.exportCsv">
                            <i data-lucide="download" aria-hidden="true"></i> <span data-i18n="export.exportCsv">CSV</span>
                        </button>
                        <button class="secondary outline" id="export-odt-btn" aria-label="Zapisz raport jako ODT" data-i18n-aria="export.exportOdt">
                            <i data-lucide="file-text" aria-hidden="true"></i> <span data-i18n="export.exportOdt">ODT</span>
                        </button>
                    </div>
                </article>

                <!-- New Audit -->
                <div style="margin-top: 2rem; text-align: center;">
                    <button class="secondary outline" onclick="resetAudit()" style="width: 100%;">
                        <i data-lucide="refresh-cw" aria-hidden="true"></i> <span data-i18n="summary.newAuditButton">Rozpocznij nowy audyt</span>
                    </button>
                </div>

            </div>

        </main>
    </div>

    <footer role="contentinfo" class="app-footer">
        <!-- Inline SVG to allow CSS coloring -->
        <svg class="acr" aria-hidden="true" focusable="false" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path class="fill-color-icon-svg" d="m12.032 3c-3.751 0-6.9913 2.2649-8.4727 5.5212-0.051613-0.0060071-0.10422-0.010045-0.15737-0.010045-0.77358 0-1.4012 0.65435-1.4012 1.4598 0 0.57262 0.31644 1.0681 0.77679 1.3058-0.050761 0.40042-0.077009 0.8095-0.077009 1.2238 0 2.7747 1.1743 5.2742 3.0435 7.0095-0.07315 0.17682-0.11384 0.3729-0.11384 0.57757 0 0.80547 0.62765 1.4581 1.4012 1.4581 0.40083 0 0.7636-0.17511 1.0179-0.45536 1.2087 0.58321 2.5587 0.90904 3.9827 0.90904 1.4407 0 2.8057-0.33309 4.0229-0.9308 0.25243 0.25559 0.59798 0.41183 0.97768 0.41183 0.77358 0 1.4012-0.65267 1.4012-1.4581 0-0.18616-0.034497-0.36512-0.095424-0.52734 1.8581-1.7377 3.0251-4.2293 3.0251-6.9944 0-0.4049-0.024539-0.80502-0.07366-1.1953 0.42451-0.25079 0.70982-0.72473 0.70982-1.269 0-0.80547-0.62764-1.4598-1.4012-1.4598l-0.066964 0.0033482c-1.4688-3.2883-4.726-5.5798-8.4994-5.5798zm0 0.94922c3.3855 0 6.3106 2.0509 7.6373 4.9955-0.28881 0.26731-0.4721 0.65776-0.4721 1.0915 0 0.058316 0.004321 0.11576 0.011718 0.17243-4.7327 2.9164-9.4282 2.9685-14.16 0.15569l-0.26451-0.16071 0.013393-0.11551 0.0050223-0.11719c0-0.40022-0.1556-0.76291-0.40848-1.0262 1.3279-2.9447 4.252-4.9955 7.6373-4.9955zm-0.031808 2.1998a2.5672 2.5672 0 0 0-2.5664 2.5681 2.5672 2.5672 0 0 0 2.5664 2.5664 2.5672 2.5672 0 0 0 2.5664-2.5664 2.5672 2.5672 0 0 0-2.5664-2.5681zm0 0.92578a1.6418 1.6418 0 0 1 1.6406 1.6423 1.6418 1.6418 0 0 1-1.6406 1.6423 1.6418 1.6418 0 0 1-1.6406-1.6423 1.6418 1.6418 0 0 1 1.6406-1.6423zm-8.6283 2.2282c0.362 0 0.65625 0.29889 0.65625 0.66797 0 0.36907-0.29425 0.66797-0.65625 0.66797-0.362 0-0.65625-0.29889-0.65625-0.66797 0-0.36907 0.29425-0.66797 0.65625-0.66797zm17.196 0.063616c0.362 0 0.65625 0.30057 0.65625 0.66964 0 0.36908-0.29425 0.66797-0.65625 0.66797-0.362 0-0.65458-0.29889-0.65458-0.66797 0-0.36907 0.29258-0.66964 0.65458-0.66964zm-16.235 1.6942 0.31975 0.19252c2.0818 1.2233 4.169 1.9265 6.2578 2.1077l-3.8086 5.2701-0.070312-0.003348c-0.24146 0-0.46803 0.064622-0.66629 0.17746-1.6776-1.5643-2.7305-3.8118-2.7305-6.3047 0-0.37511 0.023646-0.74498 0.071987-1.1049 0.23695-0.054756 0.45102-0.17254 0.62612-0.33482zm15.295 0.025111c0.19981 0.2 0.45541 0.33846 0.74163 0.38672 0.039788 0.33681 0.060267 0.68036 0.060267 1.0279 0 2.4724-1.0359 4.7024-2.6886 6.2628-0.20804-0.1274-0.44947-0.20089-0.70815-0.20089-0.10462 0-0.20659 0.012487-0.30469 0.035156l-3.7935-5.2249c2.234-0.1661 4.4672-0.92884 6.6931-2.2868zm-7.7093 2.5195 4.0061 5.5229c-0.18383 0.24685-0.29297 0.55762-0.29297 0.89397 0 0.066057 0.003033 0.13171 0.013393 0.19587-1.095 0.53359-2.32 0.83203-3.6127 0.83203-1.29 0-2.513-0.29762-3.6044-0.83036l0.0050223-0.13225c0-0.41484-0.16643-0.79064-0.43359-1.0564l3.9191-5.4258zm5.0843 5.7472c0.362 0 0.65625 0.30057 0.65625 0.66964 0 0.36908-0.29425 0.66797-0.65625 0.66797-0.362 0-0.65625-0.29889-0.65625-0.66797 0-0.36907 0.29425-0.66964 0.65625-0.66964zm-9.9994 0.06529c0.362 0 0.65458 0.30057 0.65458 0.66964 0 0.36907-0.29257 0.66797-0.65458 0.66797-0.362 0-0.65625-0.2989-0.65625-0.66797 0-0.36908 0.29425-0.66964 0.65625-0.66964z" />
        </svg>
        <span>Aplikacja Dostępna Cyfrowo</span>
    </footer>

    <!-- Application Logic -->
    <script src="js/utils.js?v=13"></script>
    <script type="module" src="js/summary.js?v=13"></script>

    <!-- Global status message for screen readers -->
    <div id="status-message" role="status" aria-live="polite" class="sr-only"></div>
</body>

</html>