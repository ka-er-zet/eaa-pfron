<!DOCTYPE html>
<html lang="pl" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raport zgodności z EAA - Podsumowanie</title>

    <!-- Pico CSS (Semantic Framework) -->
    <link rel="stylesheet" href="css/pico.min.css">
    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/style.css?v=6">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.webmanifest">
    <!-- Favicon and app icons (explicit links to avoid 404 on root /favicon.ico) -->
    <link rel="icon" href="favicon.ico">
    <link rel="icon" type="image/svg+xml" href="favicon-eaa.svg">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icon-180.png">

    <!-- Lucide Icons -->
    <script src="js/lucide.min.js"></script>
    <!-- JSZip for ODT export -->
    <script src="js/jszip.min.js"></script>
</head>

<body class="summary-page">

    <!-- Header -->
    <header class="app-header">
        <div class="header-content">
            <a href="index.html" id="app-logo" class="header-icon-container" aria-label="Strona główna">
                <i data-lucide="shield-check" color="white"></i>
            </a>
            <div>
                <strong class="header-title">EAA-CR</strong>
                <small class="text-muted">Wynik audytu</small>
            </div>
        </div>
        <div class="header-actions">
            <button class="outline secondary theme-toggle" id="btn-save-audit" aria-label="Zapisz audyt">
                <i data-lucide="save" aria-hidden="true"></i>
            </button>
            <button class="outline secondary theme-toggle" onclick="window.utils.toggleTheme()"
                aria-label="Przełącz motyw">
                <i id="theme-icon" data-lucide="moon"></i>
            </button>
        </div>
    </header>

    <!-- Layout Container -->
    <div id="app-layout" class="app-layout">

        <!-- Main Content -->
        <main class="index-main">

            <div class="container">
                <!-- Header Section -->
                <div class="summary-header-section" style="margin-bottom: 1rem;">
                    <div>
                        <h1>Raport Końcowy</h1>
                        <h2 id="summary-product" class="text-muted summary-product-name"
                            style="margin-top: 0.5rem; font-weight: 500;">Ładowanie...</h2>
                    </div>
                </div>

                <!-- Verdict Card -->
                <div id="verdict-card" class="verdict-card">
                    <div class="verdict-icon-wrapper">
                        <i id="verdict-icon" data-lucide="shield-alert"></i>
                    </div>
                    <div class="verdict-content">
                        <small class="verdict-label">WYNIK AUDYTU</small>
                        <h2 id="verdict-title" class="verdict-title">NIEZGODNY (FAILED)</h2>
                        <p id="verdict-desc" class="verdict-desc">Znaleziono błędy krytyczne.</p>
                    </div>
                </div>

                <!-- Szczegóły -->
                <article class="mb-2">
                    <header class="section-header">
                        <h2>Szczegóły</h2>
                    </header>
                    <div class="section-content">
                        <details>
                            <summary>
                                <span class="summary-closed">Rozwiń szczegóły</span>
                                <span class="summary-open">Zwiń szczegóły</span>
                            </summary>
                            <!-- Issues List (Fail) -->
                            <div class="list-section">
                                <div class="list-header fail-header">
                                    <div class="header-left">
                                        <i data-lucide="x-circle"></i>
                                        <h3 style="margin: 0; font-size: inherit;">NIEZALICZONE (<span
                                                id="count-fail">0</span>)</h3>
                                    </div>
                                    <span class="badge-fail">Wymagana poprawa</span>
                                </div>
                                <div id="list-fail" class="issue-list">
                                    <!-- Items will be injected here -->
                                </div>
                            </div>

                            <!-- To Verify List (Notes/Manual) -->
                            <div class="list-section">
                                <div class="list-header warning-header">
                                    <div class="header-left">
                                        <i data-lucide="alert-circle"></i>
                                        <h3 style="margin: 0; font-size: inherit;">NIETESTOWANE (<span
                                                id="count-verify">0</span>)</h3>
                                    </div>
                                    <span class="badge-warning">Wymagana ocena</span>
                                </div>
                                <div id="list-verify" class="issue-list">
                                    <!-- Items will be injected here -->
                                </div>
                            </div>

                            <!-- NA List -->
                            <div class="list-section">
                                <div class="list-header na-header">
                                    <div class="header-left">
                                        <i data-lucide="minus-circle"></i>
                                        <h3 style="margin: 0; font-size: inherit;">NIE DOTYCZY (<span
                                                id="count-na">0</span>)</h3>
                                    </div>
                                </div>
                                <div id="list-na" class="issue-list">
                                    <!-- Items will be injected here -->
                                </div>
                            </div>

                            <!-- NT List -->
                            <div class="list-section">
                                <div class="list-header nt-header">
                                    <div class="header-left">
                                        <i data-lucide="help-circle"></i>
                                        <h3 style="margin: 0; font-size: inherit;">NIE DO SPRAWDZENIA (<span
                                                id="count-nt">0</span>)</h3>
                                    </div>
                                </div>
                                <div id="list-nt" class="issue-list">
                                    <!-- Items will be injected here -->
                                </div>
                            </div>

                            <!-- Passed List -->
                            <div class="list-section">
                                <div class="list-header success-header">
                                    <div class="header-left">
                                        <i data-lucide="check-circle"></i>
                                        <h3 style="margin: 0; font-size: inherit;">ZALICZONE (<span
                                                id="count-pass">0</span>)</h3>
                                    </div>
                                </div>
                                <div id="list-pass" class="issue-list">
                                    <!-- Items will be injected here -->
                                </div>
                            </div>
                        </details>
                    </div>
                </article>

                <!-- Executive Summary -->
                <article class="mb-2">
                    <header class="section-header">
                        <h2>Komentarz audytorski</h2>
                    </header>
                    <div class="section-content">
                        <label for="executive-summary"
                            style="display:block; margin-bottom: 0.5rem; font-weight: 600;">Treść komentarza</label>
                        <small id="executive-summary-helper" class="text-muted"
                            style="display: block; margin-bottom: 0.5rem;">
                            Wpisz tutaj syntezę audytu dla klienta. Np: 'Mimo dużej liczby zaliczonych testów...'
                        </small>
                        <textarea id="executive-summary" rows="4"
                            aria-describedby="executive-summary-helper"></textarea>
                    </div>
                </article>

                <!-- Export Section -->
                <article class="mb-2">
                    <header class="section-header">
                        <h2>Zapisz raport jako:</h2>
                    </header>
                    <div class="section-content grid">
                        <button class="secondary outline" id="export-json-btn" aria-label="Zapisz raport jako JSON">
                            <i data-lucide="code"></i> JSON
                        </button>
                        <button class="secondary outline" id="export-csv-btn" aria-label="Zapisz raport jako CSV">
                            <i data-lucide="download"></i> CSV
                        </button>
                        <button class="secondary outline" id="export-odt-btn" aria-label="Zapisz raport jako ODT">
                            <i data-lucide="file-text"></i> ODT
                        </button>
                    </div>
                </article>

                <!-- New Audit -->
                <div style="margin-top: 2rem; text-align: center;">
                    <button class="secondary outline" onclick="resetAudit()" style="width: 100%;">
                        <i data-lucide="refresh-cw"></i> Rozpocznij nowy audyt
                    </button>
                </div>

            </div>

        </main>
    </div>

    <!-- Application Logic -->
    <script src="js/utils.js"></script>
    <script src="js/summary.js"></script>
</body>

</html>