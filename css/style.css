/* --- MOTYW: GŁĘBOKI ŁUPKOWY I DOSTĘPNY POMARAŃCZOWY --- */
:root {
    /* Ustawienia globalne */
    --border-radius: 8px;
    --nav-width: 350px;

    /* Statusy - Wspólne */
    --pass-color: hsl(160, 84%, 39%);
    /* #10B981 */
    --pass-bg: hsla(160, 84%, 39%, 0.15);
    --fail-color: hsl(350, 80%, 40%);
    /* #B91C1C - Ciemniejszy czerwony dla trybu jasnego */
    --fail-bg: hsla(350, 89%, 60%, 0.15);
    --na-color: hsl(215, 25%, 40%);
    /* #4C5F7A - Ciemniejszy łupkowy dla trybu jasnego */
    --na-bg: hsla(215, 16%, 47%, 0.15);
    --nt-color: hsl(30, 100%, 25%);
    /* #804000 - Wysoki kontrast spalonego pomarańczowego */
    --nt-bg: hsla(30, 100%, 50%, 0.15);

    /* Kolor główny - Globalne nadpisanie */
    --primary: hsl(224, 76%, 48%);
    /* Niebieski 700 */
    --primary-hover: hsl(224, 76%, 38%);
    /* Niebieski 800 */
    --primary-focus: hsla(224, 76%, 48%, 0.35);
    --primary-inverse: hsl(0, 0%, 100%);

    /* Globalne ustawienia fokusu */
    --focus-color: hsl(224, 76%, 48%);
    --content-x-pad: 2rem;
    /* poziome wypełnienie treści używane przez nagłówek i pasek boczny */

    /* Skala typograficzna minor third (1.2) zastosowana do elementów nawigacji */
    --type-base: 0.8rem;
    /* rozmiar bazowy dla małych elementów nawigacji */
    --minor-third: 1.2;
    /* Mnożnik skali */
    --type-0: var(--type-base);
    --type-1: calc(var(--type-0) * var(--minor-third));
    --type-2: calc(var(--type-1) * var(--minor-third));
    --type-3: calc(var(--type-2) * var(--minor-third));
    --type-4: calc(var(--type-3) * var(--minor-third));

    /* Paleta łupkowa (Tailwind-ish) */
    --slate-50: #f8fafc;
    --slate-100: #f1f5f9;
    --slate-200: #e2e8f0;
    --slate-300: #cbd5e1;
    --slate-400: #94a3b8;
    --slate-500: #64748b;
    --slate-600: #475569;
    --slate-700: #334155;
    --slate-800: #1e293b;
    --slate-900: #0f172a;
    --slate-950: #020617;

    --blue-400: #60a5fa;
    --blue-500: #3b82f6;
    --blue-600: #2563eb;

    /* Sidebar Theme Variables */
    --sidebar-bg: var(--slate-100);
    --sidebar-border: var(--slate-200);
    --sidebar-text-primary: var(--slate-900);
    --sidebar-text-secondary: var(--slate-600);
    --sidebar-text-tertiary: var(--slate-400);
    --sidebar-hover-bg: #ffffff;
    --sidebar-active-bg: #ffffff;
    --sidebar-active-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --sidebar-active-border: var(--blue-600);
    --nav-id-color: var(--blue-600);
    --nav-id-active-color: var(--blue-600);

    /* Layout Safe Area */
    --page-bottom-pad: calc(4rem + env(safe-area-inset-bottom));
}

/* Global Focus Style - High Visibility */
*:focus-visible {
    outline: 3px solid var(--focus-color) !important;
    outline-offset: 2px !important;
    border-radius: 2px;
    /* Slight rounding for aesthetics */
}

/* Skip Link */
.skip-link {
    position: absolute;
    top: -9999px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--primary);
    color: white;
    padding: 1rem var(--content-x-pad);
    z-index: 9999;
    text-decoration: none;
    border-radius: 0 0 8px 8px;
    font-weight: bold;
    transition: top 0.2s;
}

.skip-link:focus {
    top: 0;
}

/* Skip Nav Link (Inside Sidebar) */
.skip-nav-link {
    position: absolute;
    top: -9999px;
    left: 0;
    background: var(--primary);
    color: white;
    padding: 0.5rem 1rem;
    z-index: 10;
    width: 100%;
    text-align: center;
    font-weight: bold;
    text-decoration: none;
}

.skip-nav-link:focus {
    position: static;
    top: auto;
    display: block;
    margin-bottom: 1rem;
}

/* Dark Mode Overrides */
[data-theme="dark"] {
    --background-color: hsl(222, 47%, 11%);
    /* Slate 900 */
    --card-background-color: hsl(215, 32%, 17%);
    /* Slate 800 */
    --color: hsl(214, 32%, 91%);
    /* Slate 200 */
    --h1-color: hsl(210, 40%, 98%);

    /* Sidebar Dark Mode */
    --sidebar-bg: #111827;
    /* Slate 900ish */
    --sidebar-border: var(--slate-800);
    --sidebar-text-primary: #ffffff;
    --sidebar-text-secondary: var(--slate-400);
    --sidebar-text-tertiary: var(--slate-600);
    --sidebar-hover-bg: rgba(30, 41, 59, 0.5);
    /* Slate 800/50 */
    --sidebar-active-bg: var(--slate-800);
    --sidebar-active-border: var(--blue-500);
    --nav-id-color: var(--blue-500);
    --nav-id-active-color: var(--blue-400);
    --h2-color: hsl(210, 40%, 98%);
    --h3-color: hsl(210, 40%, 98%);
    --muted-color: hsl(215, 20%, 65%);
    /* Slate 400 */

    /* High Contrast Red for Dark Mode */
    --fail-color: hsl(350, 100%, 79%);
    /* #FF94A6 */

    /* High Contrast Amber for Dark Mode */
    --nt-color: hsl(38, 92%, 50%);
    /* #F59E0B */

    /* High Contrast Green for Dark Mode */
    --ins-color: hsl(160, 84%, 50%);

    /* Focus Color for Dark Mode - High Contrast Yellow/Orange */
    --focus-color: hsl(38, 92%, 60%);

    /* Force Override - Must match :root */
    --primary: hsl(224, 76%, 48%);
    /* Blue 700 */
    --primary-hover: hsl(224, 76%, 38%);
    /* Blue 800 */
    --primary-focus: hsla(224, 76%, 48%, 0.35);
    --primary-inverse: hsl(0, 0%, 100%);
}

/* Light Mode Overrides */
[data-theme="light"] {
    --background-color: hsl(210, 40%, 98%);
    /* Slate 50 */
    --card-background-color: hsl(0, 0%, 100%);
    /* White */
    --color: hsl(215, 25%, 27%);
    /* Slate 700 */
    --h1-color: hsl(222, 47%, 11%);
    /* Slate 900 */
    --h2-color: hsl(222, 47%, 11%);
    --h3-color: hsl(222, 47%, 11%);
    --muted-color: hsl(215, 25%, 27%);
    /* #334155 - Slate 700 DARKER */

    /* Focus Color for Light Mode - Deep Blue */
    --focus-color: hsl(224, 76%, 40%);

    /* Force Override - Must match :root */
    --primary: hsl(224, 76%, 48%);
    /* Blue 700 */
    --primary-hover: hsl(224, 76%, 38%);
    /* Blue 800 */
    --primary-focus: hsla(224, 76%, 48%, 0.35);
    --primary-inverse: hsl(0, 0%, 100%);
}

/* Light Mode Override with High Specificity - Matches Pico CSS selector */
:root:not([data-theme="dark"]) {
    /* Muted color override - DARKER for better contrast */
    --muted-color: hsl(215, 25%, 27%);
    /* #334155 - Slate 700 */

    /* Force Override - Must match :root */
    --primary: hsl(224, 76%, 48%);
    /* Blue 700 */
    --primary-hover: hsl(224, 76%, 38%);
    /* Blue 800 */
    --primary-focus: hsla(224, 76%, 48%, 0.35);
    --primary-inverse: hsl(0, 0%, 100%);
}

body {
    margin: 0;
    height: 100vh;
    height: 100dvh;
    /* Dynamic viewport height for mobile browsers */
    display: grid;
    grid-template-rows: auto 1fr;
    overflow: hidden;
    background-color: var(--background-color);
    color: var(--color);
}

/* --- Header --- */
.app-header {
    background-color: var(--card-background-color);
    border-bottom: 1px solid var(--muted-color);
    padding: 0.75rem var(--content-x-pad);
    display: flex;
    align-items: center;
    justify-content: space-between;
    z-index: 10;
}

.header-content {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.header-actions {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.header-icon-container {
    background: var(--primary);
    padding: 8px;
    border-radius: 8px;
    display: flex;
    color: var(--primary-inverse);
    text-decoration: none;
    transition: opacity 0.2s ease;
}

.header-icon-container:hover {
    opacity: 0.9;
}

.header-title {
    display: block;
    line-height: 1.2;
}

.theme-toggle {
    padding: 0;
    border: none;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--border-radius);
    margin: 0;
}

.theme-toggle:focus {
    outline: 2px solid var(--primary);
    outline-offset: 2px;
}

/* --- Layout --- */
.app-layout {
    display: grid;
    grid-template-columns: 1fr;
    height: 100%;
    overflow: hidden;
    position: relative;
    /* Ensure absolute positioning works for children */
}

/* Default (Mobile < 992px): Sidebar hidden, single column */
.app-layout.with-sidebar {
    grid-template-columns: 1fr;
}

/* --- Sidebar --- */
aside {
    background-color: var(--sidebar-bg);
    border-right: 1px solid var(--sidebar-border);
    padding: 0;
    display: none;
    flex-direction: column;
    overflow-y: hidden;
}

/* Mobile: Sidebar remains hidden even with .with-sidebar class */
.app-layout.with-sidebar aside {
    display: none;
}

/* Mobile Menu Toggle Button */
#menu-toggle {
    display: flex;
    margin-right: 0.5rem;
}

/* Mobile Menu Open State */
.app-layout.mobile-menu-open aside {
    display: flex;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 50;
}

/* Desktop / Tablet (>= 992px) */
@media (min-width: 992px) {
    #menu-toggle {
        display: none;
    }

    .app-layout.with-sidebar {
        grid-template-columns: 350px 1fr;
        /* Fixed width */
    }

    .app-layout.with-sidebar aside {
        display: flex;
        /* Show sidebar */
        position: static;
        /* Reset position */
        width: auto;
        height: auto;
        z-index: auto;
        border-right: 1px solid var(--sidebar-border);
    }
}

/* Large Desktop (>= 1200px) */
@media (min-width: 1200px) {
    .app-layout.with-sidebar {
        grid-template-columns: 1fr 3fr;
        /* 1/4 width for sidebar */
    }
}

.sidebar-top-section {
    padding: 1.5rem 2rem 1rem 2rem;
    /* Align with nav items */
    border-bottom: 1px solid var(--sidebar-border);
    background-color: var(--sidebar-bg);
    z-index: 2;
}

.sidebar-header {
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: 700;
    margin-bottom: 0;
}

/* Removed .sidebar-footer as it is no longer used */

.progress-bar {
    height: 6px;
    margin-top: 0.5rem;
    --color: var(--primary);
}

/* --- Navigation Items (Inspiration Style) --- */
.nav-item {
    display: flex;
    align-items: flex-start;
    /* Align top for multiline text */
    justify-content: space-between;
    gap: 0.75rem;
    padding: 0.5rem 1rem 0.5rem 2rem;
    /* Adjusted padding */
    cursor: pointer;
    position: relative;
    border-radius: 0.5rem;
    /* rounded-lg */
    margin-bottom: 0.125rem;
    /* Reduced margin */
    transition: all 0.2s ease-in-out;
    background: transparent;
    border: none;
    /* Reset border */
    width: 100%;
    text-align: left;
    color: var(--sidebar-text-secondary);
}

/* Hover State */
.nav-item:hover {
    background-color: var(--sidebar-hover-bg) !important;
    color: var(--sidebar-text-secondary);
    /* Keep text color on hover unless active */
    text-decoration: none !important;
}

.nav-item:hover .nav-id {
    color: var(--blue-500);
    /* Slightly darker on hover? */
}

/* Active State */
.nav-item.active,
a.nav-item.active {
    background-color: var(--sidebar-active-bg) !important;
    box-shadow: var(--sidebar-active-shadow);
    color: var(--sidebar-text-primary) !important;
}

/* Active Indicator Line */
.nav-item.active::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0.75rem;
    bottom: 0.75rem;
    width: 4px;
    background-color: var(--sidebar-active-border);
    border-top-right-radius: 9999px;
    border-bottom-right-radius: 9999px;
}

/* Typography & Layout */
.nav-text-wrapper {
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
    /* gap-0.5 */
    flex: 1;
    z-index: 10;
    min-width: 0;
    /* Allow flex child to shrink below content size */
    word-wrap: break-word;
    /* Ensure long words wrap */
}

.nav-id {
    font-family: var(--font-mono, monospace);
    font-size: var(--type-0);
    /* 0.8rem ~ 12.8px */
    line-height: 1;
    color: var(--nav-id-color);
    transition: color 0.2s;
}

.nav-item.active .nav-id {
    color: var(--nav-id-active-color);
    /* Active ID color */
    font-weight: 600;
}

.nav-title {
    font-size: var(--type-1);
    /* ~15.36px */
    line-height: 1.375;
    /* leading-snug */
    font-weight: 500;
    color: inherit;
    /* Inherits from nav-item (secondary or primary) */
    transition: color 0.2s;
}

.nav-item.active .nav-title {
    color: var(--sidebar-text-primary);
}

/* Icon Wrapper */
.nav-icon-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-top: 0.375rem;
    /* Align with text roughly */
    opacity: 0.8;
    transition: opacity 0.2s;
}

.nav-item:hover .nav-icon-wrapper {
    opacity: 1;
}

/* Reset link styles for nav items */
a.nav-item,
a.nav-item:link,
a.nav-item:visited,
a.nav-item:active {
    text-decoration: none !important;
    color: var(--sidebar-text-secondary);
}

a.nav-item.active {
    color: var(--sidebar-text-primary) !important;
}

/* Focus Styles */
.nav-item:focus-visible {
    outline: 2px solid var(--blue-500);
    outline-offset: -2px;
}

/* Clause Headers (Now structured as DIVs inside LI) */
.nav-clause {
    margin-top: 1rem;
    /* Reduced top margin */
    margin-bottom: 0.75rem;
    /* Further increased bottom margin */
    padding-left: 0rem;
    /* px-3 */
    padding-right: 2rem;
    border-bottom: 1px solid var(--sidebar-border);
    /* Same color as sidebar border */

    /* Typography merged from .nav-clause-title */
    font-size: var(--type-0);
    /* 0.8rem */
    font-weight: 700;
    text-transform: none;
    /* letter-spacing: 0.05em; tracking-wider */
    color: var(--sidebar-text-secondary);
    font-family: var(--font-mono, monospace);
    display: block;
    /* Ensure it behaves like a block */
}

/* Reduce top margin for the first clause header */
.nav-clause:first-of-type {
    margin-top: 0rem;
}

/* Semantic list structure for nav */
.nav-list {
    list-style: none;
    padding: 0rem 0rem 2rem 2.5rem;
    /* Added bottom padding */
    margin: 0;
}

/* Nested Group for Tests */
.nav-group {
    list-style: none;
    padding: 0;
    margin: 0;
}

/* Align nav container with main content padding */
#nav-container {
    padding: 0 !important;
    /* Let nav-list handle padding */
    margin-top: 1rem;
    overflow-x: hidden;
    /* Prevent horizontal scrollbar */
}

/* Removed duplicate/conflicting nav styles */

/* --- Navigation Headings (Refactored for Inspiration Style) --- */
.nav-heading {
    padding: 0.5rem 2rem 0.25rem 0.75rem;
    /* Reduced padding */
    margin-top: 1.25rem;
    /* Increased top margin for section separation */
    margin-bottom: 0.125rem;
    /* Matches nav-item margin */
    pointer-events: none;
    /* Structural only */
    border: none;
    /* Remove separator lines */
    display: block;
    /* Ensure correct block rendering */

    /* Typography merged from .nav-heading-title */
    font-size: var(--type-0);
    /* 0.8rem - Small like clause headers */
    font-weight: 600;
    color: var(--sidebar-text-secondary);
    /* Slightly darker than tertiary */
    text-transform: none;
    /* Normal case for sub-headings */
    letter-spacing: 0.01em;
    line-height: 1.3;
    font-family: var(--font-mono, monospace);
    /* Use monospace font */
}

/* Ensure no hover effects on headings */
.nav-heading:hover {
    background: transparent;
}

/* Make the test title smaller so the content area is less visually overwhelming */
#test-renderer .test-title {
    font-size: 1.05rem;
    /* smaller but still prominent */
    margin: 0;
}

/* Section subheading inserted above a test view (matches nav heading label) */
.section-subheading {
    font-size: 0.95rem;
    margin: 0 0 0.5rem 0;
    color: var(--muted-color);
    font-weight: 600;
    /* less bold than 800 */
    text-transform: none;
    /* stop forcing uppercase on headings */
}

/* Give anchored content a scroll margin so deep links are not hidden under the header */
#test-renderer article[role="region"],
#test-renderer section[role="region"],
#test-renderer article[id^="test-"],
#test-renderer section[id^="test-"] {
    scroll-margin-top: 4rem;
    /* adjust according to header height */
}

/* Links in test content */
#test-renderer a {
    color: var(--primary);
    text-decoration: underline;
}

/* Dark theme link color */
[data-theme="dark"] #test-renderer a {
    color: var(--blue-400);
}

/* --- Main Content --- */
main {
    padding: 2rem;
    padding-bottom: var(--page-bottom-pad);
    /* Added bottom padding with safe area */
    overflow-y: auto;
    position: relative;
}

/* .setup-container single definition removed, unified with .index-main below */

.setup-header {
    text-align: center;
    margin-bottom: 1.5rem;
}

.section-header {
    border-bottom: 1px solid var(--muted-color);
}

.section-header h2 {
    font-size: 1.1rem;
    margin-bottom: 0;
    font-weight: 700;
}

.section-content {
    padding: 0;
}

.card-footer {
    text-align: right;
    border-top: 1px solid var(--muted-color);
    padding: 1rem 2rem;
}

.btn-auto {
    width: auto;
    margin-bottom: 0;
    padding-left: 2rem;
    padding-right: 2rem;
}

/* --- Scope Grid --- */
.scope-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 0.75rem;
}

.scope-item {
    display: flex;
    flex-direction: column;
}

.scope-card {
    background: var(--card-background-color);
    border: 1px solid var(--muted-color);
    padding: 1rem;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: all 0.2s;
    display: flex !important;
    flex-direction: row !important;
    align-items: center !important;
    gap: 1.25rem;
    width: 100%;
    height: 100%;
    text-align: left;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
    margin-top: 1rem;
}

.scope-card i,
.scope-card svg {
    flex-shrink: 0;
}

/* Smaller top spacing for the first item in the scope grid so it sits closer to the section header */
.scope-grid>.scope-item:first-child .scope-card {
    margin-top: 0.25rem;
}

.eval-btn {
    background: var(--card-background-color);
    border: 2px solid var(--muted-color);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    color: var(--muted-color);
}

.eval-btn:hover {
    border-color: var(--color);
    color: var(--color);
}

/* Selected States */
.eval-btn.pass.selected {
    background: var(--pass-bg);
    border-color: var(--pass-color);
    color: var(--pass-color);
}

.eval-btn.fail.selected {
    background: var(--fail-bg);
    border-color: var(--fail-color);
    color: var(--fail-color);
}

.eval-btn.na.selected {
    background: var(--na-bg);
    border-color: var(--na-color);
    color: var(--na-color);
}

.eval-btn.nt.selected {
    background: var(--nt-bg);
    border-color: var(--nt-color);
    color: var(--nt-color);
}

/* Button-like Link Utility */
.btn-primary {
    display: inline-block;
    background-color: var(--primary);
    color: var(--primary-inverse);
    border: 1px solid var(--primary);
    padding: 0.75rem 2rem;
    border-radius: var(--border-radius);
    text-decoration: none !important;
    text-align: center;
    cursor: pointer;
    transition: background-color 0.2s, border-color 0.2s, color 0.2s;
    line-height: normal;
    /* Reset line-height if needed */
}

.btn-primary:hover {
    background-color: var(--primary-hover);
    border-color: var(--primary-hover);
    color: var(--primary-inverse);
    opacity: 1;
    /* Reset opacity from header-icon-container if inherited */
}

.btn-primary:focus-visible {
    outline: 3px solid var(--focus-color);
    outline-offset: 2px;
}

.btn-full-width {
    width: 100%;
}

/* --- Dialog --- */
#app-confirm-dialog {
    text-align: center;
    max-width: 500px;
    border-radius: var(--border-radius);
    padding: 2rem;
}

#app-confirm-dialog h3 {
    margin-bottom: 1rem;
}

#app-confirm-dialog .dialog-actions {
    display: flex;
    justify-content: center;
    gap: 1rem;
    margin-top: 1.5rem;
}

/* --- Utilities --- */
.hidden {
    display: none !important;
}

.text-muted {
    color: var(--muted-color);
}

.text-center {
    text-align: center;
}

.mb-0 {
    margin-bottom: 0 !important;
}

.mb-05 {
    margin-bottom: 0.5rem;
}

.mb-2 {
    margin-bottom: 1rem;
}

.mb-3 {
    margin-bottom: 1.5rem;
}

.badge {
    font-size: 0.75rem;
    padding: 2px 8px;
    border-radius: 12px;
    font-weight: 700;
    text-transform: uppercase;
}

.poziom-a {
    background: var(--secondary);
    color: white;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 0.8rem;
}

/* Clause title header shown in nav to separate clauses - REMOVED DUPLICATE */
/* .nav-clause definition is now at line 433 */

.poziom-aa {
    background: var(--primary);
    color: white;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 0.8rem;
}

/* Summary View Utilities */
.summary-container {
    text-align: center;
}

.summary-icon-wrapper {
    width: 80px;
    height: 80px;
    background: var(--pass-bg);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 2rem;
    color: var(--pass-color);
}

.summary-product-name {
    font-size: 1.2rem;
    margin-bottom: 0;
}

.summary-grid {
    gap: 2rem;
    margin-bottom: 3rem;
}

.stat-card {
    margin: 0;
    text-align: center;
    padding: 2rem;
}

.stat-value {
    font-size: 3rem;
    font-weight: 800;
    line-height: 1;
}

.stat-label {
    text-transform: uppercase;
    letter-spacing: 1px;
}

.text-pass {
    color: var(--pass-color);
}

.text-fail {
    color: var(--fail-color);
}

.text-na {
    color: var(--na-color);
}

/* --- Scope Fieldset & Checkboxes --- */
.scope-fieldset {
    border: none;
    padding: 0;
    margin: 0;
    scroll-margin-top: 2rem;
    /* Ensure error message is visible when scrolled to */
}

.visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* Checkbox Logic */
.scope-checkbox:checked+.scope-card {
    background: hsla(224, 76%, 48%, 0.1);
    border-color: var(--primary);
}

.scope-checkbox:checked+.scope-card i {
    color: var(--primary);
}

.scope-checkbox:focus+.scope-card {
    outline: 3px solid var(--focus-color);
    outline-offset: 2px;
}

/* --- Validation Overrides --- */

/* Shared Validation Styles */
input[aria-invalid="true"],
select[aria-invalid="true"],
textarea[aria-invalid="true"] {
    border-color: var(--fail-color) !important;
    box-shadow: none;
    /* Reset default shadow */
}

input[aria-invalid="true"]:focus,
select[aria-invalid="true"]:focus,
textarea[aria-invalid="true"]:focus {
    border-color: var(--fail-color) !important;
    box-shadow: 0 0 0 2px var(--fail-color) !important;
    /* Custom focus ring */
}

/* Light Mode Validation Icon (Dark Red) */
:root,
[data-theme="light"] {
    --icon-invalid: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23b8142e' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'%3E%3C/circle%3E%3Cline x1='12' y1='8' x2='12' y2='12'%3E%3C/line%3E%3Cline x1='12' y1='16' x2='12.01' y2='16'%3E%3C/line%3E%3C/svg%3E");
}

input[aria-invalid="true"],
select[aria-invalid="true"],
textarea[aria-invalid="true"] {
    background-image: var(--icon-invalid) !important;
}

/* Dark Mode Validation Icon (Pastel Red) */
[data-theme="dark"] {
    --icon-invalid: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23FF94A6' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'%3E%3C/circle%3E%3Cline x1='12' y1='8' x2='12' y2='12'%3E%3C/line%3E%3Cline x1='12' y1='16' x2='12.01' y2='16'%3E%3C/line%3E%3C/svg%3E");
}

/* --- MODAL (DIALOG) --- */
dialog {
    background-color: var(--card-background-color);
    color: var(--color);
    border: 1px solid var(--muted-color);
    border-radius: var(--border-radius);
    padding: 2rem;
    width: 100%;
    /* Ensure it takes width up to max-width */
    max-width: 500px;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);

    /* Flex Layout for Vertical Stacking */
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

dialog::backdrop {
    background-color: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(2px);
}

dialog h3 {
    margin-top: 0;
    margin-bottom: 0.5rem;
    /* Add spacing below title */
    color: var(--h1-color);
}

dialog p {
    margin-bottom: 0;
    /* Let gap handle spacing */
}

dialog .dialog-actions {
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
    margin-top: 1rem;
    /* Reduced margin since we have gap */
}

dialog button {
    width: auto;
    margin-bottom: 0;
}

/* --- Button Overrides --- */
/* Secondary Outline Button Styling */
:is(button, input[type=submit], input[type=button], [role=button]).outline.secondary {
    /* Default (Light Mode) Blue */
    --btn-blue: var(--primary);

    color: var(--btn-blue);
    border-color: var(--btn-blue);
    background-color: transparent;
    transition: all 0.2s ease-in-out;
}

/* Dark Mode Blue Override */
[data-theme="dark"] :is(button, input[type=submit], input[type=button], [role=button]).outline.secondary {
    --btn-blue: var(--blue-400);
}

/* Hover & Focus States */
:is(button, input[type=submit], input[type=button], [role=button]).outline.secondary:hover,
:is(button, input[type=submit], input[type=button], [role=button]).outline.secondary:focus {
    background-color: var(--btn-blue);
    border-color: var(--btn-blue);
    color: var(--primary-inverse);
}

/* --- Navigation Headings (Duplicates Removed) --- */
/* The main definition is now around line 466 */

/* --- Evaluation Criteria --- */
.evaluation-criteria {
    display: grid;
    gap: 1rem;
    margin-top: 1rem;
}

.criteria-option {
    background: var(--card-background-color);
    border: 1px solid var(--muted-color);
    border-radius: var(--border-radius);
    padding: 1rem;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.criteria-option:hover {
    border-color: var(--primary);
    transform: translateY(-2px);
}

.criteria-option.selected {
    border-width: 2px;
}

.criteria-option.pass.selected {
    border-color: var(--pass-color);
    background: var(--pass-bg);
    color: var(--pass-color);
}

.criteria-option.fail.selected {
    border-color: var(--fail-color);
    background: var(--fail-bg);
    color: var(--fail-color);
}

.criteria-option.na.selected {
    border-color: var(--na-color);
    background: var(--na-bg);
    color: var(--na-color);
}

.criteria-option.nt.selected {
    border-color: var(--nt-color);
    background: var(--nt-bg);
    color: var(--nt-color);
}

.criteria-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 700;
}

.criteria-text {
    font-size: 0.9rem;
    color: var(--color);
    line-height: 1.4;
}

/* anchor-based hover selectors removed - handled in main block */

/* Ensure text in nav uses muted color but keep icons untouched - REMOVED CONFLICTING OVERRIDE */
/* Colors are now handled by specific .nav-id / .nav-title rules using sidebar variables */

/* Link role overrides are no longer necessary — anchors are used for nav items. */

/* Hover styles only for text, keep icons and background unaffected */
/* (Hover coloring already handled above for strong specificity) */

/* --- Evaluation Radio Buttons --- */
.criteria-option-wrapper,
.eval-btn-wrapper {
    display: flex;
    flex-direction: column;
}

/* Focus styles for the label when the hidden radio is focused */
.criteria-radio:focus+.criteria-option,
.eval-radio:focus+.eval-btn {
    outline: 3px solid var(--focus-color);
    outline-offset: 2px;
}

/* Ensure the label behaves like a button */
.criteria-option,
.eval-btn {
    width: 100%;
    height: 100%;
}

/* Secondary Outline Button Override for Dark Mode - Handled in Button Overrides section */

/* --- Scrollbar Styling --- */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: transparent;
}

::-webkit-scrollbar-thumb {
    background-color: var(--slate-300);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background-color: var(--slate-400);
}

[data-theme="dark"] ::-webkit-scrollbar-thumb {
    background-color: var(--slate-700);
}

[data-theme="dark"] ::-webkit-scrollbar-thumb:hover {
    background-color: var(--slate-600);
}

/* --- New Summary Page Styles --- */

/* Page Layout Overrides for Summary */
body.summary-page {
    height: auto;
    overflow-y: auto;
    display: block;
}

body.summary-page .app-layout {
    height: auto;
    overflow: visible;
    display: block;
}

.index-main,
.setup-container {
    padding: 2rem;
    max-width: 800px;
    margin: 0 auto;
    width: 100%;
    box-sizing: border-box;
}

/* Mobile-specific tweaks: allow summary to use full width and reduce side padding */
@media (max-width: 768px) {

    .index-main,
    .setup-container {
        padding-left: 1rem;
        padding-right: 1rem;
        max-width: 100%;
        box-sizing: border-box;
    }
}

/* Responsive tables inside test/descriptions and content containers */
#test-renderer table,
.index-main table,
.setup-container table {
    width: 100%;
    max-width: 100%;
    border-collapse: collapse;
}

/* Ensure table can be scrolled horizontally on small screens */
@media (max-width: 768px) {

    #test-renderer table,
    .index-main table,
    .setup-container table {
        display: block;
        /* allow overflow-x */
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        /* smooth scrolling on iOS */
        white-space: nowrap;
        /* preserve table columns horizontally */
    }

    /* Reduce cell padding on smaller screens */
    #test-renderer table th,
    #test-renderer table td,
    .index-main table th,
    .index-main table td,
    .setup-container table th,
    .setup-container table td {
        padding: 0.25rem 0.5rem;
        white-space: normal;
        /* wrap long content within cells */
        word-break: break-word;
    }
}

.summary-header-section {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 2rem;
    flex-wrap: wrap;
    gap: 1rem;
}

.summary-header-section h1 {
    margin-bottom: 0.25rem;
    font-size: 2rem;
}

.summary-actions {
    display: flex;
    gap: 0.5rem;
}

/* Verdict Card */
.verdict-card {
    background-color: var(--card-background-color);
    border: 1px solid var(--muted-border-color);
    border-radius: 1rem;
    padding: 2rem;
    display: flex;
    align-items: center;
    gap: 1.5rem;
    margin-bottom: 2rem;
    position: relative;
    overflow: hidden;
}

.verdict-card.failed {
    background-color: rgba(198, 40, 40, 0.1);
    /* Red tint */
    border: 1px solid var(--del-color);
}

.verdict-card.passed {
    background-color: rgba(56, 142, 60, 0.1);
    /* Green tint */
    border: 1px solid var(--ins-color);
}

.verdict-card.in-progress {
    background-color: rgba(251, 191, 36, 0.1);
    /* Amber tint */
    border: 1px solid #fbbf24;
}

.verdict-icon-wrapper {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.verdict-card.failed .verdict-icon-wrapper {
    background-color: rgba(198, 40, 40, 0.2);
    color: var(--del-color);
}

.verdict-card.passed .verdict-icon-wrapper {
    background-color: rgba(56, 142, 60, 0.2);
    color: var(--ins-color);
}

.verdict-card.in-progress .verdict-icon-wrapper {
    background-color: rgba(251, 191, 36, 0.2);
    color: #fbbf24;
}

[data-theme="light"] .verdict-card.in-progress .verdict-icon-wrapper {
    color: #d97706;
}

.verdict-content {
    flex: 1;
}

.verdict-label {
    text-transform: uppercase;
    font-weight: 700;
    font-size: 0.75rem;
    letter-spacing: 1px;
    opacity: 0.8;
    display: block;
    margin-bottom: 0.25rem;
}

.verdict-card.failed .verdict-label {
    color: var(--del-color);
}

.verdict-card.passed .verdict-label {
    color: var(--ins-color);
}

.verdict-card.in-progress .verdict-label {
    color: #fbbf24;
}

[data-theme="light"] .verdict-card.in-progress .verdict-label {
    color: #d97706;
}

.verdict-title {
    margin: 0;
    font-size: 1.75rem;
    font-weight: 800;
    line-height: 1.2;
}

.verdict-card.failed .verdict-title {
    color: var(--del-color);
}

.verdict-card.passed .verdict-title {
    color: var(--ins-color);
}

.verdict-card.in-progress .verdict-title {
    color: #fbbf24;
}

[data-theme="light"] .verdict-card.in-progress .verdict-title {
    color: #d97706;
}

.verdict-desc {
    margin: 0.5rem 0 0 0;
    opacity: 0.9;
}

/* Mobile layout adjustments for verdict card - stack content and reduce sizes so text fits */
@media (max-width: 768px) {
    .verdict-card {
        flex-direction: column;
        align-items: center;
        gap: 0.75rem;
        padding: 1rem;
        text-align: center;
    }

    .verdict-icon-wrapper {
        width: 48px;
        height: 48px;
    }

    .verdict-title {
        font-size: 1.25rem;
        font-weight: 700;
    }

    .verdict-desc {
        font-size: 0.95rem;
        margin-top: 0.25rem;
    }

    /* Place header badges under the section name for small screens */
    .list-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
        padding: 0.75rem 1rem;
    }

    .list-header h3 {
        text-align: left;
        width: 100%;
    }

    .list-header .header-left {
        width: 100%;
        gap: 0.5rem;
        align-items: center;
    }

    .list-header .badge-fail,
    .list-header .badge-warning,
    .list-header .badge-fail,
    .list-header .badge-warning,
    .list-header .badge {
        align-self: flex-start;
        margin-top: 0;
    }

    /* Stack clause ID, title and comments vertically inside issue items */
    .issue-title {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 0.25rem;
    }

    .issue-id {
        min-width: 0;
        margin-right: 0;
        margin-bottom: 0.25rem;
    }
}

.verdict-card.failed .verdict-desc {
    color: var(--del-color);
}

.verdict-card.passed .verdict-desc {
    color: var(--ins-color);
}

.verdict-card.in-progress .verdict-desc {
    color: #fbbf24;
}

[data-theme="light"] .verdict-card.in-progress .verdict-desc {
    color: #d97706;
}

/* Dark mode overrides for better contrast */
[data-theme="dark"] .verdict-card.failed .verdict-label {
    color: var(--fail-color);
}

[data-theme="dark"] .verdict-card.failed .verdict-title {
    color: var(--fail-color);
}

[data-theme="dark"] .verdict-card.failed .verdict-desc {
    color: var(--fail-color);
}

/* List Sections */
.list-section {
    margin-bottom: 1.5rem;
    background-color: var(--card-background-color);
    border: 1px solid var(--muted-border-color);
    border-radius: 0.5rem;
    overflow: hidden;
}

.list-header {
    padding: 1rem 1.5rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-weight: 700;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin: 0;
}

.list-header .header-left {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.fail-header {
    background-color: rgba(198, 40, 40, 0.1);
    color: var(--del-color);
    border-bottom: 1px solid rgba(198, 40, 40, 0.2);
}

.warning-header {
    background-color: rgba(255, 193, 7, 0.1);
    color: #fbbf24;
    /* Amber 400 */
    border-bottom: 1px solid rgba(255, 193, 7, 0.2);
}

[data-theme="light"] .warning-header {
    color: #d97706;
}

/* Amber 600 for light mode */

.success-header {
    background-color: var(--pass-bg);
    color: var(--pass-color);
    border-bottom: 1px solid var(--pass-bg);
}

.na-header {
    background-color: var(--na-bg);
    color: var(--na-color);
    border-bottom: 1px solid var(--na-bg);
}

.nt-header {
    background-color: var(--nt-bg);
    color: var(--nt-color);
    border-bottom: 1px solid var(--nt-bg);
}

.badge-fail {
    background-color: rgba(198, 40, 40, 0.2);
    color: var(--del-color);
    padding: 0.25rem 0.75rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 700;
}

.badge-warning {
    background-color: rgba(255, 193, 7, 0.2);
    color: #fbbf24;
    padding: 0.25rem 0.75rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 700;
}

[data-theme="light"] .badge-warning {
    color: #d97706;
}

.issue-list {
    /* padding: 0 1.5rem; */
}

.issue-item {
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--muted-border-color);
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

[data-theme="dark"] .issue-item {
    border-bottom-color: var(--slate-600);
}

.issue-item:last-child {
    border-bottom: none;
}

.issue-id {
    font-family: var(--font-mono);
    font-size: 0.8rem;
    color: var(--muted-color);
    margin-right: 0.5rem;
    display: inline-block;
    min-width: 5rem;
    flex-shrink: 0;
}

.issue-title {
    font-weight: 600;
    font-size: 1rem;
    display: flex;
    align-items: baseline;
}

.issue-text {
    display: block;
}

.issue-desc {
    font-size: 0.9rem;
    color: var(--del-color);
    margin-top: 0.25rem;
}

.issue-note {
    font-size: 0.9rem;
    color: var(--muted-color);
    margin-top: 0.25rem;
    font-style: italic;
}

/* Dark mode overrides for fail section contrast */
[data-theme="dark"] .fail-header {
    color: var(--fail-color);
}

[data-theme="dark"] .badge-fail {
    color: var(--fail-color);
}

[data-theme="dark"] .issue-desc {
    color: var(--fail-color);
}

/* Details marker (chevron) color */
details summary::-webkit-details-marker {
    color: inherit;
}

/* Custom details marker for better control */
details {
    margin-bottom: 0;
    padding-bottom: 0;
    border-bottom: none;
}

details summary {
    list-style: none;
    color: var(--primary) !important;
    font-weight: 700;
    margin-bottom: 0;
    cursor: pointer;
    transition: color 0.2s;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* Chevron using ::after with mask to allow coloring via currentColor */
details summary::after {
    content: "";
    width: 1.25rem;
    height: 1.25rem;
    background-color: currentColor;
    -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='black' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
    mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='black' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
    -webkit-mask-repeat: no-repeat;
    mask-repeat: no-repeat;
    -webkit-mask-position: center;
    mask-position: center;
    -webkit-mask-size: contain;
    mask-size: contain;
    transition: transform 0.2s;
    opacity: 0.8;
}

details[open] summary::after {
    transform: rotate(180deg);
}

details summary:hover {
    color: var(--primary) !important;
    text-decoration: underline;
}

details summary:hover::after {
    opacity: 1;
}

details[open] summary {
    color: var(--primary) !important;
    margin-bottom: 1rem;
    border-bottom: 1px solid var(--muted-border-color);
    padding-bottom: 1rem;
}

/* Dark mode for details */
[data-theme="dark"] details summary {
    color: var(--blue-400) !important;
}

[data-theme="dark"] details summary:hover {
    color: hsl(217, 91%, 75%) !important;
}

[data-theme="dark"] details[open] summary {
    color: var(--blue-400) !important;
}

/* Toggle summary text */
.summary-open {
    display: none;
}

details[open] summary .summary-closed {
    display: none;
}

details[open] summary .summary-open {
    display: inline;
}

/* --- Landing Page Cards --- */
.setup-container .grid {
    gap: 2rem;
}

.card-action {
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    text-align: center;
    background-color: var(--card-background-color);
    border-radius: var(--border-radius);
    /* Padding removed to inherit Pico CSS article padding and fix header alignment */
}

.card-action header {
    margin-bottom: 0.5rem;
}

.card-action h2 {
    margin-bottom: 0.5rem;
}

.card-action p {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 0.5rem;
}

.card-action footer {
    margin-top: auto;
    border-top: 1px solid var(--muted-color);
    padding-top: 1rem;
    background: transparent;
    flex-shrink: 0;
}

.card-action footer button,
.card-action footer [role="button"] {
    margin-bottom: 0;
}

.btn-full-width {
    width: 100%;
}

/* Optional wrapper for tables to provide smooth scrolling and hint that table is scrollable */
.table-responsive {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    /* smooth scroll on iOS */
    max-width: 100%;
}

.table-responsive table {
    width: 100%;
    border-collapse: collapse;
}